ligatures = {
 'alef.fina': '',
#'alef.fina.alt': '',
 'alef.isol': '',
 'ayn+haa.init':    ('ayn.init', 'haa.medi'),
 'ayn+meem.init':   ('ayn.init', 'meem.medi'),
 'ayn+yaa.fina':    ('ayn.medi', 'yaa.fina'),
 'ayn+yaa.isol':    ('ayn.init', 'yaa.fina'),
 'ayn.fina': '',
 'ayn.init': '',
#'ayn.init.alt': '',
 'ayn.isol': '',
 'ayn.medi': '',
 'baa+baa+haa.init':    ('baa.init', 'baa.medi', 'haa.medi'),
 'baa+baa+meem.init':   ('baa.init', 'baa.medi', 'meem.medi'),
 'baa+baa+yaa.isol':    ('baa.init', 'baa.medi', 'yaa.fina'),
 'baa+baa.init':        ('baa.init', 'baa.medi'),
#'baa+baa.init.alt':    ('baa.init', 'baa.medi'),
 'baa+baa.isol':        ('baa.init', 'baa.fina'),
 'baa+dal.isol':        ('baa.init', 'dal.fina'),
 'baa+heh.init':        ('baa.init', 'heh.medi'),
 'baa+heh.medi':        ('baa.medi', 'heh.medi'),
 'baa+meem+alef.fina':  ('baa.medi', 'meem.medi', 'alef.fina'),
 'baa+meem+haa.init':   ('baa.init', 'meem.medi', 'haa.medi'),
 'baa+meem.fina':       ('baa.medi', 'meem.fina'),
 'baa+meem.init':       ('baa.init', 'meem.medi'),
 'baa+meem.isol':       ('baa.init', 'meem.fina'),
 'baa+noon.fina':       ('baa.medi', 'noon.fina'),
 'baa+noon.isol':	('baa.init', 'noon.fina'),
 'baa+raa.fina':	('baa.medi', 'raa.fina'),
 'baa+raa.isol':	('baa.init', 'raa.fina'),
 'baa+seen.init':	('baa.init', 'seen.medi'),
#'baa+seen.init.alt':	'',
 'baa+yaa.isol':	('baa.init', 'yaa.fina'),
 'baa.fina':	'',
 'baa.init':	'',
 'baa.isol':	'',
 'baa.medi':	'',
#'baa.medi.alt':	'',
#'colon':	'',
#'coma':	'',
 'dal.fina':	'',
 'dal.isol':	'',
#'dash':	'',
#'dot.double':	'',
#'dot.single':	'',
#'dot.tripple':	'',
 'faa+haa.init':    ('faa.init', 'haa.medi'),
 'faa+meem.init':   ('faa.init', 'meem.medi'),
 'faa+yaa.fina':    ('faa.medi', 'yaa.fina'),
 'faa+yaa.isol':    ('faa.init', 'yaa.fina'),
 'faa.fina':	'',
 'faa.init':	'',
 'faa.isol':	'',
 'faa.medi':	'',
 'haa+haa.init':    ('haa.init', 'haa.medi'),
 'haa+meem.init':   ('haa.init', 'meem.medi'),
 'haa+raa.isol':    ('haa.init', 'raa.fina'),
 'haa+yaa.isol':    ('haa.init', 'yaa.fina'),
 'haa.fina':	'',
 'haa.init':	'',
#'haa.init.alt':	'',
 'haa.isol':	'',
 'haa.medi':	'',
#'haa.medi.alt':	'',
#'hamza':	'',
#'hamza.small':	'',
 'heh+haa.init':    ('heh.init', 'haa.medi'),
 'heh+meem.init':   ('heh.init', 'meem.medi'),
 'heh.fina':	'',
 'heh.init':	'',
 'heh.isol':	'',
 'heh.medi':	'',
 'kaf+alef.fina':   ('kaf.medi', 'alef.fina'),
 'kaf+alef.isol':   ('kaf.init', 'alef.fina'),
 'kaf+baa.init':    ('kaf.init', 'baa.medi'),
 'kaf+baa.medi':    ('kaf.medi', 'baa.medi'),
 'kaf+dal.isol':    ('kaf.init', 'dal.fina'),
 'kaf+heh.fina':    ('kaf.medi', 'heh.fina'),
 'kaf+heh.isol':    ('kaf.init', 'heh.fina'),
 'kaf+kaf.fina':    ('kaf.medi', 'kaf.fina'),
 'kaf+lam+alef.fina':	('kaf.medi', 'lam.medi', 'alef.fina'),
 'kaf+lam+alef.isol':	('kaf.init', 'lam.medi', 'alef.fina'),
 'kaf+lam+meem.medi':	('kaf.medi', 'lam.medi', 'meem.medi'),
 'kaf+lam.init':	('kaf.init', 'lam.medi'),
 'kaf+lam.isol':	('kaf.init', 'lam.fina'),
 'kaf+lam.medi':	('kaf.medi', 'lam.medi'),
 'kaf+meem+alef.fina':	('kaf.medi', 'meem.medi', 'alef.fina'),
 'kaf+meem+alef.isol':	('kaf.init', 'meem.medi', 'alef.fina'),
 'kaf+meem+lam.fina':	('kaf.medi', 'meem.medi', 'lam.fina'),
 'kaf+meem+lam.init':	('kaf.init', 'meem.medi', 'lam.medi'),
 'kaf+meem.fina':	('kaf.medi', 'meem.fina'),
 'kaf+meem.init':	('kaf.init', 'meem.medi'),
 'kaf+meem.isol':	('kaf.init', 'meem.fina'),
#'kaf+meem.isol.alt':	'',
 'kaf+meem.medi':	('kaf.medi', 'meem.medi'),
 'kaf+raa.fina':	('kaf.medi', 'raa.fina'),
 'kaf+raa.isol':	('kaf.init', 'raa.fina'),
 'kaf+yaa.fina':	('kaf.medi', 'yaa.fina'),
 'kaf+yaa.isol':	('kaf.init', 'yaa.fina'),
 'kaf.fina':	'',
 'kaf.init':	'',
#'kaf.init.alt':	'',
 'kaf.isol':	'',
 'kaf.medi':	'',
 'lam+alef.fina':	('lam.medi', 'alef.fina'),
 'lam+alef.isol':	('lam.init', 'alef.fina'),
 'lam+baa+meem.init':	('lam.init', 'baa.medi', 'meem.medi'),
 'lam+dal.isol':	('lam.init', 'dal.fina'),
#'lam+haa+haa.init':	('lam.init', 'haa.medi', 'haa.medi'),
 'lam+haa+meem.init':	('lam.init', 'haa.medi', 'meem.medi'),
 'lam+haa.init':	('lam.init', 'haa.medi'),
 'lam+heh.fina':	('lam.medi', 'heh.fina'),
 'lam+heh.init':	('lam.init', 'heh.medi'),
 'lam+heh.isol':	('lam.init', 'heh.fina'),
 'lam+kaf.fina':	('lam.medi', 'kaf.fina'),
 'lam+kaf.isol':	('lam.init', 'kaf.fina'),
 'lam+lam+alef.isol':	('lam.init', 'lam.medi', 'alef.fina'),
 'lam+lam+haa.init':	('lam.init', 'lam.medi', 'haa.medi'),
 'lam+lam.init':	('lam.init', 'lam.medi'),
 'lam+meem+haa.init':	('lam.init', 'meem.medi', 'haa.medi'),
 'lam+meem.fina':	('lam.medi', 'meem.fina'),
 'lam+meem.init':	('lam.init', 'meem.medi'),
 'lam+meem.isol':	('lam.init', 'meem.fina'),
 'lam+meem.medi':	('lam.medi', 'meem.medi'),
 'lam+qaf.fina':	('lam.medi', 'qaf.fina'),
 'lam+raa.isol':	('lam.init', 'raa.fina'),
 'lam+waw.fina':	('lam.medi', 'waw.fina'),
 'lam+yaa.fina':	('lam.medi', 'yaa.fina'),
 'lam+yaa.isol':	('lam.init', 'yaa.fina'),
 'lam.fina':	'',
 'lam.init':	'',
 'lam.isol':	'',
 'lam.medi':	'',
 'lellah':	        ('lam.init', 'lam.medi', 'heh.fina'),
#'madda':	'',
 'meem+alef.fina':	('meem.medi', 'alef.fina'),
 'meem+haa+meem.init':	('meem.init', 'haa.medi', 'meem.medi'),
 'meem+haa.init':	('meem.init', 'haa.medi'),
 'meem+meem.init':	('meem.init', 'meem.medi'),
 'meem+raa.isol':	('meem.init', 'raa.fina'),
 'meem+yaa.isol':	('meem.init', 'yaa.fina'),
 'meem.fina':	'',
#'meem.fina.alt':	'',
 'meem.init':	'',
 'meem.isol':	'',
 'meem.medi':	'',
 'noon.fina':	'',
#'noon.fina.alt':	'',
 'noon.isol':	'',
#'noon.isol.alt':	'',
 'qaf.fina':	'',
 'qaf.isol':	'',
#'question-mark':	'',
 'raa.fina':	'',
#'raa.fina.alt':	'',
#'raa.fina.alt2':	'',
 'raa.isol':	'',
 'sad+haa.init':    ('sad.init', 'haa.medi'),
 'sad+haa.isol':    ('sad.init', 'haa.fina'),
 'sad+meem.init':   ('sad.init', 'meem.medi'),
 'sad.fina':	'',
 'sad.init':	'',
#'sad.init.alt':	'',
 'sad.isol':	'',
 'sad.medi':	'',
 'seen+baa+meem.init':	('seen.init', 'baa.medi', 'meem.medi'),
 'seen+haa.init':	('seen.init', 'haa.medi'),
 'seen+haa.isol':	('seen.init', 'haa.fina'),
 'seen+meem.init':	('seen.init', 'meem.medi'),
 'seen.fina':	'',
 'seen.init':	'',
#'seen.init.alt':	'',
 'seen.isol':	'',
 'seen.medi':	'',
#'seen.medi.alt':	'',
#'semicolon':	'',
 'taa.fina':	'',
 'taa.init':	'',
 'taa.isol':	'',
 'taa.medi':	'',
 'waw.fina':	'',
 'waw.isol':	'',
 'yaa.fina':	'',
#'yaa.fina.alt':'',
 'yaa.isol':    '',
 }
import fontforge

font = fontforge.open("AmiriText-Regular.sfd")

fea  = "languagesystem DFLT dflt;\nlanguagesystem arab dflt;\n\n"

inits = ""
medis = ""
finas = ""
calts = ""
sngls = ""

for ligature in ligatures:
    components  = ligatures[ligature]
    lookup_name = ligature.title().replace("+", "").replace(".", "")
    font.selection.select(ligature)
    font.copy()
    font.createChar(-1, ligature).color = 0xff0000

    if len(components) == 0:
        name = ligature.split(".")
        sub  = "    sub \\%s by \\%s ;\n" %(name[0]+".isol", ligature)
        if name[1] == "init":
            inits += sub
        elif name[1] == "medi":
            medis += sub
        elif name[1] == "fina":
            finas += sub
    else:
        subs = ""
        calt = ""
        for component in components:
            name = "%s_%s"                          %(component, lookup_name)
            subs = subs +"    sub \\%s by \\%s ;\n" %(component, name)
            calt = calt +"\\%s' lookup %s "         %(component, lookup_name)

            font.createChar(-1, name).color = 0x00ff00
            font.selection.select(name)
            font.paste()

        sub_lookup  = "lookup %s {\n%s} %s;" %(lookup_name, subs, lookup_name)
        sngls      += sub_lookup + "\n\n"
        calts      += "    sub %s;\n" % calt

fea += "feature init {\n%s} init;\n\n" % inits
fea += "feature medi {\n%s} medi;\n\n" % medis
fea += "feature fina {\n%s} fina;\n\n" % finas

fea += sngls
fea += "feature calt {\n%s} calt;\n\n" % calts

fea_file=open("AmiriText-Regular.fea", "w")
fea_file.write(fea)
fea_file.close()

font.mergeFeature("AmiriText-Regular.fea")
font.save() 
